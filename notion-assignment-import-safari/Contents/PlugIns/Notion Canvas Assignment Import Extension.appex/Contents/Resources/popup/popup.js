!function(){var e=function(e){var t;return function(r){return t||e(t={exports:{},parent:r},t.exports),t.exports}},t=e((function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CONFIGURATION=void 0;const a=r({});t.CONFIGURATION={get FIELDS(){return delete this.FIELDS,this.FIELDS=Object.fromEntries(Object.entries(t.CONFIGURATION.OPTIONS).flatMap((function e([t,r]){return a=r,["elementId","defaultValue","Validator"].every(e=>Object.keys(a).includes(e))?[[t,r]]:Object.entries(r).flatMap(([r,a])=>e([`${t}.${r}`,a]));var a})))},OPTIONS:{timeZone:{elementId:"timezone",defaultValue:"Pacific/Auckland",Validator:a.TimeZoneField},canvas:{classNames:{breadcrumbs:{elementId:"breadcrumbs",defaultValue:"ic-app-crumbs",Validator:a.RequiredStringField},assignment:{elementId:"assignment-class",defaultValue:"assignment",Validator:a.RequiredStringField},title:{elementId:"assignment-title",defaultValue:"ig-title",Validator:a.RequiredStringField},availableDate:{elementId:"available-date",defaultValue:"assignment-date-available",Validator:a.RequiredStringField},availableStatus:{elementId:"available-status",defaultValue:"status-description",Validator:a.RequiredStringField},dueDate:{elementId:"due-date",defaultValue:"assignment-date-due",Validator:a.RequiredStringField},dateElement:{elementId:"date-element",defaultValue:"screenreader-only",Validator:a.RequiredStringField}},classValues:{courseCodeN:{elementId:"course-code-n",defaultValue:"2",Validator:a.RequiredNumberField},notAvailable:{elementId:"status-not-available",defaultValue:"Not available until",Validator:a.RequiredStringField}},courseCodeOverrides:{elementId:"course-code-overrides",defaultValue:"{}",Validator:a.JSONStringObjectField}},notion:{notionKey:{elementId:"notion-key",defaultValue:null,Validator:a.RequiredNotionKeyField,validateOn:"change"},databaseId:{elementId:"database-id",defaultValue:null,Validator:a.RequiredNotionDatabaseIdField,validateOn:"change"},propertyNames:{name:{elementId:"notion-property-name",defaultValue:"Name",Validator:a.RequiredStringField},category:{elementId:"notion-property-category",defaultValue:"Category",Validator:a.StringField},course:{elementId:"notion-property-course",defaultValue:"Course",Validator:a.StringField},url:{elementId:"notion-property-url",defaultValue:"URL",Validator:a.StringField},status:{elementId:"notion-property-status",defaultValue:"Status",Validator:a.StringField},available:{elementId:"notion-property-available",defaultValue:"Reminder",Validator:a.StringField},due:{elementId:"notion-property-due",defaultValue:"Due",Validator:a.StringField},span:{elementId:"notion-property-span",defaultValue:"Date Span",Validator:a.StringField}},propertyValues:{categoryCanvas:{elementId:"notion-category-canvas",defaultValue:"Canvas",Validator:a.StringField},statusToDo:{elementId:"notion-status-todo",defaultValue:"To Do",Validator:a.StringField}},courseEmojis:{elementId:"course-emojis",defaultValue:"{}",Validator:a.JSONEmojiObjectField}}}}})),r=e((function(e,r){"use strict";var a=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))((function(s,i){function n(e){try{l(a.next(e))}catch(t){i(t)}}function o(e){try{l(a.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}l((a=a.apply(e,t||[])).next())}))};Object.defineProperty(r,"__esModule",{value:!0}),r.TimeZoneField=r.JSONEmojiObjectField=r.JSONStringObjectField=r.RequiredNotionDatabaseIdField=r.RequiredNotionKeyField=r.RequiredNumberField=r.RequiredStringField=r.StringField=r.FieldValidator=void 0;const s=t({}),i={button:document.getElementById("save-button"),updateState(e){if(this.button&&this.button instanceof HTMLButtonElement)switch(e){case 0:this.button.innerHTML=`Validating ${n.countValidatingFields()} input${n.countValidatingFields()>1?"s":""}...`,this.button.disabled=!0;break;case 1:this.button.innerHTML=`${n.countInvalidFields()} invalid input${n.countInvalidFields()>1?"s":""}!`,this.button.disabled=!0,this.button.classList.add("red"),this.button.classList.remove("green");break;case 2:if(n.countInvalidFields()>0)return this.updateState(1);if(n.countValidatingFields()>0)return this.updateState(0);this.button.innerHTML="Save",this.button.disabled=!1,this.button.classList.add("green"),this.button.classList.remove("red")}}};class n{constructor(e,t,r,a){this.elementId=e,this.inputValue=t,this.typeGuard=r,this.type=a}static countValidatingFields(){return n.validatingFields.size}static countInvalidFields(){return n.invalidFields.size}validator(){return a(this,void 0,void 0,(function*(){return this.typeGuard(this.inputValue)?this.inputValue:(this.addInvalidError(`Input must be a ${this.type}!`),n.INVALID_INPUT)}))}validate(){return a(this,void 0,void 0,(function*(){this.addValidatingStatus();const e=yield this.validator();return this.removeValidatingStatus(),e!==n.INVALID_INPUT&&this.removeInvalidError(),e}))}addValidatingStatus(){this.removeInvalidError(),n.validatingFields.add(this.elementId);const e=document.getElementById(this.elementId);if(e){const t=document.getElementById("validating-input-"+this.elementId),r=`<span id='validating-input-${this.elementId}' class='validating-input-status'>Validating input...</span>`;t?t.innerHTML=r:e.insertAdjacentHTML("beforebegin",r)}i.updateState(0)}removeValidatingStatus(){var e;n.validatingFields.delete(this.elementId),null===(e=document.getElementById("validating-input-"+this.elementId))||void 0===e||e.remove(),i.updateState(2)}addInvalidError(e){n.invalidFields.add(this.elementId);const t=document.getElementById(this.elementId);if(t){t.classList.add("invalid-input");const r=document.getElementById("invalid-input-"+this.elementId),a=`<span id='invalid-input-${this.elementId}' class='invalid-input-error'>${e}</span>`;r?r.innerHTML=a:t.insertAdjacentHTML("beforebegin",a)}i.updateState(1)}removeInvalidError(){var e,t;n.invalidFields.delete(this.elementId),null===(e=document.getElementById(this.elementId))||void 0===e||e.classList.remove("invalid-input"),null===(t=document.getElementById("invalid-input-"+this.elementId))||void 0===t||t.remove(),i.updateState(2)}}r.FieldValidator=n,n.INVALID_INPUT=Symbol("INVALID_INPUT"),n.validatingFields=new Set,n.invalidFields=new Set;class o extends n{validator(){return a(this,void 0,void 0,(function*(){if(this.inputValue){if(this.typeGuard(this.inputValue))return this.inputValue;this.addInvalidError(`Input must be a ${this.type}!`)}else this.addInvalidError("Required field cannot be empty!");return n.INVALID_INPUT}))}}class l extends o{getCachedInput(){var e;return null===(e=l.cache)||void 0===e?void 0:e[this.elementId]}cacheInput(e){return l.cache[this.elementId]=e}}l.cache={};class d extends n{validator(){var e,t;return a(this,void 0,void 0,(function*(){try{if(!this.inputValue)return"{}";const r=JSON.parse(this.inputValue);if(r instanceof Object&&!Array.isArray(r)){if(Object.values(r).every(this.typeGuard))return null===(t=null===(e=document.getElementById(this.elementId))||void 0===e?void 0:e.classList)||void 0===t||t.remove("invalid-input"),this.inputValue;this.addInvalidError(`All object values must be ${this.type}s!`)}else this.addInvalidError("Input must be an object <code>{}</code>.");return n.INVALID_INPUT}catch(r){return this.addInvalidError("Input is not valid <code>JSON</code>."),n.INVALID_INPUT}}))}}const u=e=>"string"==typeof e||null===e,c=e=>"string"==typeof e,m=e=>"string"==typeof e&&!isNaN(Number(e)),g=e=>"string"==typeof e&&/^[\p{Emoji_Presentation}\u200D]+$/u.test(e);r.StringField=class extends n{constructor(e,t){super(e,t,u,"string")}},r.RequiredStringField=class extends o{constructor(e,t){super(e,t,c,"string")}},r.RequiredNumberField=class extends o{constructor(e,t){super(e,t,m,"number")}},r.RequiredNotionKeyField=class extends l{constructor(e,t){super(e,t,c,"string")}validator(){const e=Object.create(null,{validator:{get:()=>super.validator}});return a(this,void 0,void 0,(function*(){if(this.getCachedInput()===this.inputValue)return this.inputValue;if((yield e.validator.call(this))===this.inputValue)if(navigator.onLine){const e=new F.NotionClient({auth:this.inputValue});if(yield e.retrieveMe())return this.cacheInput(this.inputValue);this.addInvalidError("Input is not a valid Notion Integration Key.")}else this.addInvalidError("Please connect to the Internet to validate this input.");return n.INVALID_INPUT}))}},r.RequiredNotionDatabaseIdField=class extends l{constructor(e,t){super(e,t,c,"string")}getNotionKey(){return a(this,void 0,void 0,(function*(){const e=s.CONFIGURATION.FIELDS["notion.notionKey"],t=document.getElementById(e.elementId);if(t&&(t instanceof HTMLInputElement||t instanceof HTMLTextAreaElement)){const r=t.value.trim()||null;if(r){const t=new e.Validator(e.elementId,r);if(t instanceof l&&t.getCachedInput()===r)return r;const a=yield new e.Validator(e.elementId,r).validate();if(a!==n.INVALID_INPUT)return a}}return null}))}validator(){const e=Object.create(null,{validator:{get:()=>super.validator}});return a(this,void 0,void 0,(function*(){if(this.getCachedInput()===this.inputValue)return this.inputValue;if((yield e.validator.call(this))===this.inputValue){const e=yield this.getNotionKey();if(e)if(navigator.onLine){const t=new F.NotionClient({auth:e});if(yield t.retrieveDatabase(this.inputValue))return this.cacheInput(this.inputValue);this.addInvalidError("Could not find the database.<br>Verify the ID and make sure the database is shared with your integration.")}else this.addInvalidError("Please connect to the Internet to validate this input.");else this.addInvalidError("Invalid Notion Integration Key.")}return n.INVALID_INPUT}))}},r.JSONStringObjectField=class extends d{constructor(e,t){super(e,t,c,"string")}},r.JSONEmojiObjectField=class extends d{constructor(e,t){super(e,t,g,"emoji")}},r.TimeZoneField=class extends n{constructor(e,t){super(e,t,u,"string")}validator(){const e=Object.create(null,{validator:{get:()=>super.validator}});return a(this,void 0,void 0,(function*(){if(!this.inputValue)return null;if((yield e.validator.call(this))===this.inputValue)try{return Intl.DateTimeFormat(void 0,{timeZone:this.inputValue}),this.inputValue}catch(t){this.addInvalidError("Invalid time zone.")}return n.INVALID_INPUT}))}}})),a={exports:{}};!function(e,t){if("function"==typeof define&&define.amd)define("webextension-polyfill",["module"],t);else if(void 0!==a.exports)t(a);else{var r={exports:{}};t(r),e.browser=r.exports}}("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:this,(function(e){"use strict";if("object"!=typeof globalThis||"object"!=typeof chrome||!chrome||!chrome.runtime||!chrome.runtime.id)throw new Error("This script should only be loaded in a browser extension.");if(void 0===globalThis.browser||Object.getPrototypeOf(globalThis.browser)!==Object.prototype){const t="The message port closed before a response was received.",r="Returning a Promise is the preferred way to send a reply from an onMessage/onMessageExternal listener, as the sendResponse will be removed from the specs (See https://developer.mozilla.org/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onMessage)",a=e=>{const a={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(0===Object.keys(a).length)throw new Error("api-metadata.json has not been included in browser-polyfill");class s extends WeakMap{constructor(e,t){super(t),this.createItem=e}get(e){return this.has(e)||this.set(e,this.createItem(e)),super.get(e)}}const i=(t,r)=>(...a)=>{e.runtime.lastError?t.reject(new Error(e.runtime.lastError.message)):r.singleCallbackArg||a.length<=1&&!1!==r.singleCallbackArg?t.resolve(a[0]):t.resolve(a)},n=e=>1==e?"argument":"arguments",o=(e,t,r)=>new Proxy(t,{apply:(t,a,s)=>r.call(a,e,...s)});let l=Function.call.bind(Object.prototype.hasOwnProperty);const d=(e,t={},r={})=>{let a=Object.create(null),s={has:(t,r)=>r in e||r in a,get(s,u,c){if(u in a)return a[u];if(!(u in e))return;let m=e[u];if("function"==typeof m)if("function"==typeof t[u])m=o(e,e[u],t[u]);else if(l(r,u)){let t=((e,t)=>function(r,...a){if(a.length<t.minArgs)throw new Error(`Expected at least ${t.minArgs} ${n(t.minArgs)} for ${e}(), got ${a.length}`);if(a.length>t.maxArgs)throw new Error(`Expected at most ${t.maxArgs} ${n(t.maxArgs)} for ${e}(), got ${a.length}`);return new Promise((s,n)=>{if(t.fallbackToNoCallback)try{r[e](...a,i({resolve:s,reject:n},t))}catch(o){console.warn(e+" API method doesn't seem to support the callback parameter, falling back to call it without a callback: ",o),r[e](...a),t.fallbackToNoCallback=!1,t.noCallback=!0,s()}else t.noCallback?(r[e](...a),s()):r[e](...a,i({resolve:s,reject:n},t))})})(u,r[u]);m=o(e,e[u],t)}else m=m.bind(e);else if("object"==typeof m&&null!==m&&(l(t,u)||l(r,u)))m=d(m,t[u],r[u]);else{if(!l(r,"*"))return Object.defineProperty(a,u,{configurable:!0,enumerable:!0,get:()=>e[u],set(t){e[u]=t}}),m;m=d(m,t[u],r["*"])}return a[u]=m,m},set:(t,r,s,i)=>(r in a?a[r]=s:e[r]=s,!0),defineProperty:(e,t,r)=>Reflect.defineProperty(a,t,r),deleteProperty:(e,t)=>Reflect.deleteProperty(a,t)},u=Object.create(e);return new Proxy(u,s)},u=e=>({addListener(t,r,...a){t.addListener(e.get(r),...a)},hasListener:(t,r)=>t.hasListener(e.get(r)),removeListener(t,r){t.removeListener(e.get(r))}}),c=new s(e=>"function"!=typeof e?e:function(t){const r=d(t,{},{getContent:{minArgs:0,maxArgs:0}});e(r)});let m=!1;const g=new s(e=>"function"!=typeof e?e:function(t,a,s){let i,n,o=!1,l=new Promise(e=>{i=function(t){m||(console.warn(r,(new Error).stack),m=!0),o=!0,e(t)}});try{n=e(t,a,i)}catch(c){n=Promise.reject(c)}const d=!0!==n&&((u=n)&&"object"==typeof u&&"function"==typeof u.then);var u;if(!0!==n&&!d&&!o)return!1;return(d?n:l).then(e=>{s(e)},e=>{let t;t=e&&(e instanceof Error||"string"==typeof e.message)?e.message:"An unexpected error occurred",s({__mozWebExtensionPolyfillReject__:!0,message:t})}).catch(e=>{console.error("Failed to send onMessage rejected reply",e)}),!0}),p=(r,a,s,...i)=>{if(i.length<a.minArgs)throw new Error(`Expected at least ${a.minArgs} ${n(a.minArgs)} for ${r}(), got ${i.length}`);if(i.length>a.maxArgs)throw new Error(`Expected at most ${a.maxArgs} ${n(a.maxArgs)} for ${r}(), got ${i.length}`);return new Promise((r,a)=>{const n=(({reject:r,resolve:a},s)=>{e.runtime.lastError?e.runtime.lastError.message===t?a():r(new Error(e.runtime.lastError.message)):s&&s.__mozWebExtensionPolyfillReject__?r(new Error(s.message)):a(s)}).bind(null,{resolve:r,reject:a});i.push(n),s.sendMessage(...i)})},h={devtools:{network:{onRequestFinished:u(c)}},runtime:{onMessage:u(g),onMessageExternal:u(g),sendMessage:p.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:p.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},v={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return a.privacy={network:{"*":v},services:{"*":v},websites:{"*":v}},d(e,h,a)};e.exports=a(chrome)}else e.exports=globalThis.browser})),a=a.exports;var s={};Object.defineProperty(s,"__esModule",{value:!0}),s.isObject=s.pick=s.assertNever=void 0,s.assertNever=function(e){throw new Error("Unexpected value should never occur: "+e)},s.pick=function(e,t){const r=t.map(t=>[t,null==e?void 0:e[t]]);return Object.fromEntries(r)},s.isObject=function(e){return"object"==typeof e&&null!==e};var i,n={};Object.defineProperty(n,"__esModule",{value:!0}),n.logLevelSeverity=n.makeConsoleLogger=n.LogLevel=void 0,function(e){e.DEBUG="debug",e.INFO="info",e.WARN="warn",e.ERROR="error"}(i=n.LogLevel||(n.LogLevel={})),n.makeConsoleLogger=function(e){return(t,r,a)=>{console[t](`${e} ${t}:`,r,a)}},n.logLevelSeverity=function(e){switch(e){case i.DEBUG:return 20;case i.INFO:return 40;case i.WARN:return 60;case i.ERROR:return 80;default:return(0,s.assertNever)(e)}};var o,l,d={};Object.defineProperty(d,"__esModule",{value:!0}),d.buildRequestError=d.APIResponseError=d.UnknownHTTPResponseError=d.isHTTPResponseError=d.RequestTimeoutError=d.isNotionClientError=d.ClientErrorCode=d.APIErrorCode=void 0,function(e){e.Unauthorized="unauthorized",e.RestrictedResource="restricted_resource",e.ObjectNotFound="object_not_found",e.RateLimited="rate_limited",e.InvalidJSON="invalid_json",e.InvalidRequestURL="invalid_request_url",e.InvalidRequest="invalid_request",e.ValidationError="validation_error",e.ConflictError="conflict_error",e.InternalServerError="internal_server_error",e.ServiceUnavailable="service_unavailable"}(o=d.APIErrorCode||(d.APIErrorCode={})),function(e){e.RequestTimeout="notionhq_client_request_timeout",e.ResponseError="notionhq_client_response_error"}(l=d.ClientErrorCode||(d.ClientErrorCode={}));class u extends Error{}function c(e){return(0,s.isObject)(e)&&e instanceof u}function m(e,t){return c(e)&&e.code in t}d.isNotionClientError=c;class g extends u{constructor(e="Request to Notion API has timed out"){super(e),this.code=l.RequestTimeout,this.name="RequestTimeoutError"}static isRequestTimeoutError(e){return m(e,{[l.RequestTimeout]:!0})}static rejectAfterTimeout(e,t){return new Promise((r,a)=>{const s=setTimeout(()=>{a(new g)},t);e.then(r).catch(a).then(()=>clearTimeout(s))})}}d.RequestTimeoutError=g;class p extends u{constructor(e){super(e.message),this.name="HTTPResponseError";const{code:t,status:r,headers:a,rawBodyText:s}=e;this.code=t,this.status=r,this.headers=a,this.body=s}}const h={[l.ResponseError]:!0,[o.Unauthorized]:!0,[o.RestrictedResource]:!0,[o.ObjectNotFound]:!0,[o.RateLimited]:!0,[o.InvalidJSON]:!0,[o.InvalidRequestURL]:!0,[o.InvalidRequest]:!0,[o.ValidationError]:!0,[o.ConflictError]:!0,[o.InternalServerError]:!0,[o.ServiceUnavailable]:!0};d.isHTTPResponseError=function(e){return!!m(e,h)};class v extends p{constructor(e){var t;super({...e,code:l.ResponseError,message:null!==(t=e.message)&&void 0!==t?t:"Request to Notion API failed with status: "+e.status}),this.name="UnknownHTTPResponseError"}static isUnknownHTTPResponseError(e){return m(e,{[l.ResponseError]:!0})}}d.UnknownHTTPResponseError=v;const f={[o.Unauthorized]:!0,[o.RestrictedResource]:!0,[o.ObjectNotFound]:!0,[o.RateLimited]:!0,[o.InvalidJSON]:!0,[o.InvalidRequestURL]:!0,[o.InvalidRequest]:!0,[o.ValidationError]:!0,[o.ConflictError]:!0,[o.InternalServerError]:!0,[o.ServiceUnavailable]:!0};class y extends p{constructor(){super(...arguments),this.name="APIResponseError"}static isAPIResponseError(e){return m(e,f)}}d.APIResponseError=y,d.buildRequestError=function(e,t){const r=function(e){if("string"!=typeof e)return;let t;try{t=JSON.parse(e)}catch(a){return}var r;return(0,s.isObject)(t)&&"string"==typeof t.message&&"string"==typeof(r=t.code)&&r in f?{...t,code:t.code,message:t.message}:void 0}(t);return void 0!==r?new y({code:r.code,message:r.message,headers:e.headers,status:e.status,rawBodyText:t}):new v({message:void 0,headers:e.headers,status:e.status,rawBodyText:t})};var b={};Object.defineProperty(b,"__esModule",{value:!0}),b.search=b.createDatabase=b.listDatabases=b.queryDatabase=b.updateDatabase=b.getDatabase=b.appendBlockChildren=b.listBlockChildren=b.deleteBlock=b.updateBlock=b.getBlock=b.getPageProperty=b.updatePage=b.getPage=b.createPage=b.listUsers=b.getUser=b.getSelf=void 0,b.getSelf={method:"get",pathParams:[],queryParams:[],bodyParams:[],path:()=>"users/me"},b.getUser={method:"get",pathParams:["user_id"],queryParams:[],bodyParams:[],path:e=>"users/"+e.user_id},b.listUsers={method:"get",pathParams:[],queryParams:["start_cursor","page_size"],bodyParams:[],path:()=>"users"},b.createPage={method:"post",pathParams:[],queryParams:[],bodyParams:["parent","properties","icon","cover","content","children"],path:()=>"pages"},b.getPage={method:"get",pathParams:["page_id"],queryParams:[],bodyParams:[],path:e=>"pages/"+e.page_id},b.updatePage={method:"patch",pathParams:["page_id"],queryParams:[],bodyParams:["properties","icon","cover","archived"],path:e=>"pages/"+e.page_id},b.getPageProperty={method:"get",pathParams:["page_id","property_id"],queryParams:["start_cursor","page_size"],bodyParams:[],path:e=>`pages/${e.page_id}/properties/${e.property_id}`},b.getBlock={method:"get",pathParams:["block_id"],queryParams:[],bodyParams:[],path:e=>"blocks/"+e.block_id},b.updateBlock={method:"patch",pathParams:["block_id"],queryParams:[],bodyParams:["embed","type","archived","bookmark","image","video","pdf","file","audio","code","equation","divider","breadcrumb","table_of_contents","link_to_page","table_row","heading_1","heading_2","heading_3","paragraph","bulleted_list_item","numbered_list_item","quote","to_do","toggle","template","callout","synced_block","table"],path:e=>"blocks/"+e.block_id},b.deleteBlock={method:"delete",pathParams:["block_id"],queryParams:[],bodyParams:[],path:e=>"blocks/"+e.block_id},b.listBlockChildren={method:"get",pathParams:["block_id"],queryParams:["start_cursor","page_size"],bodyParams:[],path:e=>`blocks/${e.block_id}/children`},b.appendBlockChildren={method:"patch",pathParams:["block_id"],queryParams:[],bodyParams:["children"],path:e=>`blocks/${e.block_id}/children`},b.getDatabase={method:"get",pathParams:["database_id"],queryParams:[],bodyParams:[],path:e=>"databases/"+e.database_id},b.updateDatabase={method:"patch",pathParams:["database_id"],queryParams:[],bodyParams:["title","icon","cover","properties","archived"],path:e=>"databases/"+e.database_id},b.queryDatabase={method:"post",pathParams:["database_id"],queryParams:[],bodyParams:["sorts","filter","start_cursor","page_size","archived"],path:e=>`databases/${e.database_id}/query`},b.listDatabases={method:"get",pathParams:[],queryParams:["start_cursor","page_size"],bodyParams:[],path:()=>"databases"},b.createDatabase={method:"post",pathParams:[],queryParams:[],bodyParams:["parent","properties","icon","cover","title"],path:()=>"databases"},b.search={method:"post",pathParams:[],queryParams:[],bodyParams:["sort","query","start_cursor","page_size","filter"],path:()=>"search"};var A={},P=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==P)return P;throw new Error("unable to locate global object")}();A=A=P.fetch,P.fetch&&(A.default=P.fetch.bind(P)),A.Headers=P.Headers,A.Request=P.Request,A.Response=P.Response;var x,I,N,k,E,w,q,_,T,R="@notionhq/client",L="1.0.4",O={},S=this&&this.__classPrivateFieldSet||function(e,t,r,a,s){if("m"===a)throw new TypeError("Private method is not writable");if("a"===a&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===a?s.call(e,r):s?s.value=r:t.set(e,r),r},C=this&&this.__classPrivateFieldGet||function(e,t,r,a){if("a"===r&&!a)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?a:"a"===r?a.call(e):a?a.value:t.get(e)};Object.defineProperty(O,"__esModule",{value:!0});class V{constructor(e){var t,r,a,i,o,l;x.set(this,void 0),I.set(this,void 0),N.set(this,void 0),k.set(this,void 0),E.set(this,void 0),w.set(this,void 0),q.set(this,void 0),_.set(this,void 0),T.set(this,void 0),this.blocks={retrieve:e=>this.request({path:b.getBlock.path(e),method:b.getBlock.method,query:(0,s.pick)(e,b.getBlock.queryParams),body:(0,s.pick)(e,b.getBlock.bodyParams),auth:null==e?void 0:e.auth}),update:e=>this.request({path:b.updateBlock.path(e),method:b.updateBlock.method,query:(0,s.pick)(e,b.updateBlock.queryParams),body:(0,s.pick)(e,b.updateBlock.bodyParams),auth:null==e?void 0:e.auth}),delete:e=>this.request({path:b.deleteBlock.path(e),method:b.deleteBlock.method,query:(0,s.pick)(e,b.deleteBlock.queryParams),body:(0,s.pick)(e,b.deleteBlock.bodyParams),auth:null==e?void 0:e.auth}),children:{append:e=>this.request({path:b.appendBlockChildren.path(e),method:b.appendBlockChildren.method,query:(0,s.pick)(e,b.appendBlockChildren.queryParams),body:(0,s.pick)(e,b.appendBlockChildren.bodyParams),auth:null==e?void 0:e.auth}),list:e=>this.request({path:b.listBlockChildren.path(e),method:b.listBlockChildren.method,query:(0,s.pick)(e,b.listBlockChildren.queryParams),body:(0,s.pick)(e,b.listBlockChildren.bodyParams),auth:null==e?void 0:e.auth})}},this.databases={list:e=>this.request({path:b.listDatabases.path(),method:b.listDatabases.method,query:(0,s.pick)(e,b.listDatabases.queryParams),body:(0,s.pick)(e,b.listDatabases.bodyParams),auth:null==e?void 0:e.auth}),retrieve:e=>this.request({path:b.getDatabase.path(e),method:b.getDatabase.method,query:(0,s.pick)(e,b.getDatabase.queryParams),body:(0,s.pick)(e,b.getDatabase.bodyParams),auth:null==e?void 0:e.auth}),query:e=>this.request({path:b.queryDatabase.path(e),method:b.queryDatabase.method,query:(0,s.pick)(e,b.queryDatabase.queryParams),body:(0,s.pick)(e,b.queryDatabase.bodyParams),auth:null==e?void 0:e.auth}),create:e=>this.request({path:b.createDatabase.path(),method:b.createDatabase.method,query:(0,s.pick)(e,b.createDatabase.queryParams),body:(0,s.pick)(e,b.createDatabase.bodyParams),auth:null==e?void 0:e.auth}),update:e=>this.request({path:b.updateDatabase.path(e),method:b.updateDatabase.method,query:(0,s.pick)(e,b.updateDatabase.queryParams),body:(0,s.pick)(e,b.updateDatabase.bodyParams),auth:null==e?void 0:e.auth})},this.pages={create:e=>this.request({path:b.createPage.path(),method:b.createPage.method,query:(0,s.pick)(e,b.createPage.queryParams),body:(0,s.pick)(e,b.createPage.bodyParams),auth:null==e?void 0:e.auth}),retrieve:e=>this.request({path:b.getPage.path(e),method:b.getPage.method,query:(0,s.pick)(e,b.getPage.queryParams),body:(0,s.pick)(e,b.getPage.bodyParams),auth:null==e?void 0:e.auth}),update:e=>this.request({path:b.updatePage.path(e),method:b.updatePage.method,query:(0,s.pick)(e,b.updatePage.queryParams),body:(0,s.pick)(e,b.updatePage.bodyParams),auth:null==e?void 0:e.auth}),properties:{retrieve:e=>this.request({path:b.getPageProperty.path(e),method:b.getPageProperty.method,query:(0,s.pick)(e,b.getPageProperty.queryParams),body:(0,s.pick)(e,b.getPageProperty.bodyParams),auth:null==e?void 0:e.auth})}},this.users={retrieve:e=>this.request({path:b.getUser.path(e),method:b.getUser.method,query:(0,s.pick)(e,b.getUser.queryParams),body:(0,s.pick)(e,b.getUser.bodyParams),auth:null==e?void 0:e.auth}),list:e=>this.request({path:b.listUsers.path(),method:b.listUsers.method,query:(0,s.pick)(e,b.listUsers.queryParams),body:(0,s.pick)(e,b.listUsers.bodyParams),auth:null==e?void 0:e.auth}),me:e=>this.request({path:b.getSelf.path(),method:b.getSelf.method,query:(0,s.pick)(e,b.getSelf.queryParams),body:(0,s.pick)(e,b.getSelf.bodyParams),auth:null==e?void 0:e.auth})},S(this,x,null==e?void 0:e.auth,"f"),S(this,I,null!==(t=null==e?void 0:e.logLevel)&&void 0!==t?t:n.LogLevel.WARN,"f"),S(this,N,null!==(r=null==e?void 0:e.logger)&&void 0!==r?r:(0,n.makeConsoleLogger)(R),"f"),S(this,k,(null!==(a=null==e?void 0:e.baseUrl)&&void 0!==a?a:"https://api.notion.com")+"/v1/","f"),S(this,E,null!==(i=null==e?void 0:e.timeoutMs)&&void 0!==i?i:6e4,"f"),S(this,w,null!==(o=null==e?void 0:e.notionVersion)&&void 0!==o?o:V.defaultNotionVersion,"f"),S(this,q,null!==(l=null==e?void 0:e.fetch)&&void 0!==l?l:A.default,"f"),S(this,_,null==e?void 0:e.agent,"f"),S(this,T,"notionhq-client/"+L,"f")}async request({path:e,method:t,query:r,body:a,auth:s}){this.log(n.LogLevel.INFO,"request start",{method:t,path:e});const i=a&&0!==Object.entries(a).length?JSON.stringify(a):void 0,o=new URL(`${C(this,k,"f")}${e}`);if(r)for(const[n,d]of Object.entries(r))void 0!==d&&o.searchParams.append(n,String(d));const l={...this.authAsHeaders(s),"Notion-Version":C(this,w,"f"),"user-agent":C(this,T,"f")};void 0!==i&&(l["content-type"]="application/json");try{const r=await d.RequestTimeoutError.rejectAfterTimeout(C(this,q,"f").call(this,o.toString(),{method:t,headers:l,body:i,agent:C(this,_,"f")}),C(this,E,"f")),a=await r.text();if(!r.ok)throw(0,d.buildRequestError)(r,a);const s=JSON.parse(a);return this.log(n.LogLevel.INFO,"request success",{method:t,path:e}),s}catch(u){if(!(0,d.isNotionClientError)(u))throw u;throw this.log(n.LogLevel.WARN,"request fail",{code:u.code,message:u.message}),(0,d.isHTTPResponseError)(u)&&this.log(n.LogLevel.DEBUG,"failed response body",{body:u.body}),u}}search(e){return this.request({path:b.search.path(),method:b.search.method,query:(0,s.pick)(e,b.search.queryParams),body:(0,s.pick)(e,b.search.bodyParams),auth:null==e?void 0:e.auth})}log(e,t,r){(0,n.logLevelSeverity)(e)>=(0,n.logLevelSeverity)(C(this,I,"f"))&&C(this,N,"f").call(this,e,t,r)}authAsHeaders(e){const t={},r=null!=e?e:C(this,x,"f");return void 0!==r&&(t.authorization="Bearer "+r),t}}O.default=V,x=new WeakMap,I=new WeakMap,N=new WeakMap,k=new WeakMap,E=new WeakMap,w=new WeakMap,q=new WeakMap,_=new WeakMap,T=new WeakMap,V.defaultNotionVersion="2022-02-22";var j={};Object.defineProperty(j,"__esModule",{value:!0}),j.isNotionClientError=j.APIErrorCode=j.Client=void 0,Object.defineProperty(j,"Client",{enumerable:!0,get:function(){return O.default}}),Object.defineProperty(j,"LogLevel",{enumerable:!0,get:function(){return n.LogLevel}}),Object.defineProperty(j,"APIErrorCode",{enumerable:!0,get:function(){return d.APIErrorCode}}),Object.defineProperty(j,"ClientErrorCode",{enumerable:!0,get:function(){return d.ClientErrorCode}}),Object.defineProperty(j,"APIResponseError",{enumerable:!0,get:function(){return d.APIResponseError}}),Object.defineProperty(j,"UnknownHTTPResponseError",{enumerable:!0,get:function(){return d.UnknownHTTPResponseError}}),Object.defineProperty(j,"RequestTimeoutError",{enumerable:!0,get:function(){return d.RequestTimeoutError}}),Object.defineProperty(j,"isNotionClientError",{enumerable:!0,get:function(){return d.isNotionClientError}});var F={},D=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))((function(s,i){function n(e){try{l(a.next(e))}catch(t){i(t)}}function o(e){try{l(a.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}l((a=a.apply(e,t||[])).next())}))};function M(e){return!!e&&"has_more"in e}Object.defineProperty(F,"__esModule",{value:!0}),F.NotionClient=void 0;class U extends j.Client{constructor(e){super(e),this.auth=e.auth}get isRateLimited(){var e,t;return null!==(t=null===(e=U.rateLimits[this.auth])||void 0===e?void 0:e.isRateLimited)&&void 0!==t&&t}set isRateLimited(e){U.rateLimits[this.auth].isRateLimited=e}get retryAfterPromise(){var e,t;return null!==(t=null===(e=U.rateLimits[this.auth])||void 0===e?void 0:e.retryAfterPromise)&&void 0!==t?t:null}set retryAfterPromise(e){U.rateLimits[this.auth].retryAfterPromise=e}static alertRateLimited(){alert("You are being rate-limited for making too many requests too quickly.\n\nLeave this popup open and I will automatically resume once you are no longer rate-limited.\n\nAlternatively, please try again in a few minutes' time.")}static sleep(e){return D(this,void 0,void 0,(function*(){return yield new Promise(t=>setTimeout(t,e))}))}makeRequest(e,t){return D(this,void 0,void 0,(function*(){try{return this.isRateLimited&&null!==this.retryAfterPromise&&(U.alertRateLimited,yield this.retryAfterPromise),yield e(t)}catch(r){const a=(0,j.isNotionClientError)(r)?"NOTION_ERROR":"UNKNOWN_ERROR";if(console.error({type:a,error:r}),(0,j.isNotionClientError)(r)&&r.code===j.APIErrorCode.RateLimited){const a=Number(r.headers.get("Retry-After"));return this.isRateLimited=!0,this.retryAfterPromise=U.sleep(1e3*a),U.alertRateLimited,yield this.retryAfterPromise,this.isRateLimited=!1,this.retryAfterPromise=null,yield this.makeRequest(e,t)}}}))}makePaginatedRequest(e,t){return D(this,void 0,void 0,(function*(){let r=yield this.makeRequest(e,t);if(M(r)){const a=r.results;for(;M(r)&&r.has_more;)t.start_cursor=r.next_cursor,M(r=yield this.makeRequest(e,t))&&a.push(...r.results);M(r)&&(r.results=a)}return r}))}retrieveMe(){return D(this,void 0,void 0,(function*(){return yield this.makeRequest(this.users.me,{})}))}queryDatabase(e,t){return D(this,void 0,void 0,(function*(){return yield this.makePaginatedRequest(this.databases.query,{database_id:e,filter:t})}))}retrieveDatabase(e){return D(this,void 0,void 0,(function*(){return yield this.makeRequest(this.databases.retrieve,{database_id:e})}))}createPage(e){return D(this,void 0,void 0,(function*(){return yield this.makeRequest(this.pages.create,e)}))}}F.NotionClient=U,U.rateLimits={};var B={},$=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))((function(s,i){function n(e){try{l(a.next(e))}catch(t){i(t)}}function o(e){try{l(a.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}l((a=a.apply(e,t||[])).next())}))},H=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(B,"__esModule",{value:!0}),B.getOptions=void 0;const J=H(a),z=t({}),W=r({});function Z(){return $(this,void 0,void 0,(function*(){const e=Object.fromEntries(Object.entries(z.CONFIGURATION.FIELDS).map(([e,{defaultValue:t}])=>[e,t]));return yield J.default.storage.local.get(e)}))}function G(){return $(this,void 0,void 0,(function*(){const e=yield Z();Object.entries(e).forEach(([e,t])=>{!function(e,t){const r=document.getElementById(e);r&&(r instanceof HTMLInputElement||r instanceof HTMLTextAreaElement)&&(r.value=t)}(z.CONFIGURATION.FIELDS[e].elementId,t)})}))}function K(e,t){var r;return $(this,void 0,void 0,(function*(){const a=null!==(r=function(e){const t=document.getElementById(e);if(t&&(t instanceof HTMLInputElement||t instanceof HTMLTextAreaElement))return t.value.trim()||null}(e))&&void 0!==r?r:null;return yield new t(e,a).validate()}))}function Y(){return $(this,void 0,void 0,(function*(){const e=yield function(){return $(this,void 0,void 0,(function*(){const e=Object.fromEntries(yield Promise.all(Object.entries(z.CONFIGURATION.FIELDS).map(([e,{elementId:t,Validator:r}])=>$(this,void 0,void 0,(function*(){const a=yield K(t,r);return[e,a]})))));return Object.values(e).every(e=>e!==W.FieldValidator.INVALID_INPUT)?e:null}))}();e&&(yield J.default.storage.local.set(e),Q&&(Q.innerHTML="Saved!",setTimeout(()=>{Q.innerHTML="Save"},1325)),G())}))}B.getOptions=function(){return $(this,void 0,void 0,(function*(){const e=yield Z();return{timeZone:e.timeZone,canvas:{timeZone:e.timeZone,classNames:{breadcrumbs:e["canvas.classNames.breadcrumbs"],assignment:e["canvas.classNames.assignment"],title:e["canvas.classNames.title"],availableDate:e["canvas.classNames.availableDate"],availableStatus:e["canvas.classNames.availableStatus"],dueDate:e["canvas.classNames.dueDate"],dateElement:e["canvas.classNames.dateElement"]},classValues:{courseCodeN:Number(e["canvas.classValues.courseCodeN"]),notAvailable:e["canvas.classValues.notAvailable"]},selectors:{get courseCode(){return`.${e["canvas.classNames.breadcrumbs"]} li:nth-of-type(${e["canvas.classValues.courseCodeN"]}) span`},get availableStatus(){return`.${e["canvas.classNames.availableDate"]} .${e["canvas.classNames.availableStatus"]}`},get availableDate(){return`.${e["canvas.classNames.availableDate"]} .${e["canvas.classNames.dateElement"]}`},get dueDate(){return`.${e["canvas.classNames.dueDate"]} .${e["canvas.classNames.dateElement"]}`}},courseCodeOverrides:JSON.parse(e["canvas.courseCodeOverrides"])},notion:{timeZone:e.timeZone,notionKey:e["notion.notionKey"],databaseId:e["notion.databaseId"],propertyNames:{name:e["notion.propertyNames.name"],category:e["notion.propertyNames.category"],course:e["notion.propertyNames.course"],url:e["notion.propertyNames.url"],status:e["notion.propertyNames.status"],available:e["notion.propertyNames.available"],due:e["notion.propertyNames.due"],span:e["notion.propertyNames.span"]},propertyValues:{categoryCanvas:e["notion.propertyValues.categoryCanvas"],statusToDo:e["notion.propertyValues.statusToDo"]},courseEmojis:JSON.parse(e["notion.courseEmojis"])}}}))},document.addEventListener("DOMContentLoaded",G),Object.values(z.CONFIGURATION.FIELDS).forEach(({elementId:e,Validator:t,validateOn:r="input"})=>{var a;null===(a=document.getElementById(e))||void 0===a||a.addEventListener(r,()=>K(e,t))});const Q=document.getElementById("save-button");Q&&Q.addEventListener("click",Y),document.addEventListener("keydown",e=>{e.ctrlKey&&"s"===e.key&&(e.preventDefault(),Y())});var X={},ee=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))((function(s,i){function n(e){try{l(a.next(e))}catch(t){i(t)}}function o(e){try{l(a.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}l((a=a.apply(e,t||[])).next())}))},te=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(X,"__esModule",{value:!0}),X.exportToNotion=void 0;const re=te(a);X.exportToNotion=function(){return ee(this,void 0,void 0,(function*(){const{notion:e}=yield(0,B.getOptions)();class t{constructor(e){this.assignment=e}get name(){return this.assignment.name}get course(){return this.assignment.course}get icon(){return this.assignment.icon}get url(){return this.assignment.url}get available(){return this.assignment.available}get due(){return this.assignment.due}static verifySelectValue(e){return e?{name:e}:null}getPageParameters(r){var a,s,i,n,o,l,d,u;const c=Symbol("EMPTY_PROPERTY"),m={[null!==(a=e.propertyNames.name)&&void 0!==a?a:c]:{title:[{text:{content:this.name}}]},[null!==(s=e.propertyNames.category)&&void 0!==s?s:c]:{select:t.verifySelectValue(e.propertyValues.categoryCanvas)},[null!==(i=e.propertyNames.course)&&void 0!==i?i:c]:{select:{name:this.course}},[null!==(n=e.propertyNames.url)&&void 0!==n?n:c]:{url:this.url},[null!==(o=e.propertyNames.status)&&void 0!==o?o:c]:{select:t.verifySelectValue(e.propertyValues.statusToDo)},[null!==(l=e.propertyNames.available)&&void 0!==l?l:c]:{date:{start:this.available,time_zone:e.timeZone}},[null!==(d=e.propertyNames.due)&&void 0!==d?d:c]:{date:{start:this.due,time_zone:e.timeZone}},[null!==(u=e.propertyNames.span)&&void 0!==u?u:c]:{date:{start:this.available,end:this.due,time_zone:e.timeZone}}};return{parent:{database_id:r,type:"database_id"},properties:Object.fromEntries(Object.entries(m)),icon:this.icon?{emoji:this.icon}:null}}}class r{constructor(e){this.assignment=e}get name(){return"properties"in this.assignment&&"title"in this.assignment.properties.Name?this.assignment.properties.Name.title.map(({plain_text:e})=>e).join(""):""}get course(){var t;if(e.propertyNames.course&&"properties"in this.assignment&&e.propertyNames.course in this.assignment.properties){const r=this.assignment.properties[e.propertyNames.course];if("select"in r)return null===(t=r.select)||void 0===t?void 0:t.name}}get url(){if(e.propertyNames.url&&"properties"in this.assignment&&e.propertyNames.url in this.assignment.properties){const t=this.assignment.properties[e.propertyNames.url];if("url"in t&&(null==t?void 0:t.url))return t.url}}}if(!e.notionKey||!e.databaseId)return alert("Invalid Notion Integration Key or Database ID.\n\nRefer to the extension set-up instructions on GitHub for more information.");const a=new F.NotionClient({auth:e.notionKey}),s=yield function(s){return ee(this,void 0,void 0,(function*(){const i=yield function(){return ee(this,void 0,void 0,(function*(){const{savedAssignments:e}=yield re.default.storage.local.get({savedAssignments:{}});return Object.values(e).flat().map(e=>new t(e)).filter(e=>Date.parse(e.due)>Date.now())}))}(),n=yield function(){var t;return ee(this,void 0,void 0,(function*(){const i=e.propertyNames.category?{property:e.propertyNames.category,select:e.propertyValues.categoryCanvas?{equals:e.propertyValues.categoryCanvas}:{is_empty:!0}}:void 0,n=yield a.queryDatabase(s,i);return null===(t=null==n?void 0:n.results)||void 0===t?void 0:t.map(e=>new r(e))}))}();return(null==n?void 0:n.length)?i.filter(e=>!n.some(t=>t.url===e.url)):i}))}(e.databaseId);let i=0;const n=yield Promise.all(s.map(t=>ee(this,void 0,void 0,(function*(){return(yield a.createPage(t.getPageParameters(e.databaseId)))?(console.log(`Created assignment ${t.course} ${t.name}`),[t]):(console.error(`Error creating assignment ${t.course} ${t.name}`),i++,[])}))));return i&&alert(`An error was encountered when creating ${i} assignments.`),n.flat()}))};var ae={};Object.defineProperty(ae,"__esModule",{value:!0}),ae.areHTMLElements=void 0,ae.areHTMLElements=function(e){return Object.values(e).every(e=>null!==e)};var se=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))((function(s,i){function n(e){try{l(a.next(e))}catch(t){i(t)}}function o(e){try{l(a.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}l((a=a.apply(e,t||[])).next())}))},ie=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty({},"__esModule",{value:!0});const ne=ie(a);function oe(e){return document.getElementById(e)}const le={options:oe("options-button"),parse:oe("parse-button"),export:oe("export-button"),viewJSON:oe("view-json-button"),listCourses:oe("list-courses-button"),copyJSON:oe("copy-json-button"),clearStorage:oe("clear-storage-button")};function de(e,t){e instanceof HTMLElement&&(e.style.display=t)}if((0,ae.areHTMLElements)(le)){const e={DEFAULT:Object.fromEntries(Object.values(le).map(e=>[e.id,e.innerHTML])),reset(e,t){setTimeout(()=>{e.innerHTML=this.DEFAULT[e.id]},t)}};le.options.addEventListener("click",()=>{ne.default.runtime.openOptionsPage?ne.default.runtime.openOptionsPage():window.open(ne.default.runtime.getURL("options.html"))}),le.parse.addEventListener("click",()=>se(void 0,void 0,void 0,(function*(){yield ne.default.storage.local.remove("savedCourse");const[t]=yield ne.default.tabs.query({active:!0,currentWindow:!0});if(!t.id)return alert("No active tab found.");if(!(yield(ne.default.scripting?ne.default.scripting.executeScript({target:{tabId:t.id},files:["popup/parse.js"]}):ne.default.tabs.executeScript(t.id,{file:"/popup/parse.js"}).catch(e=>{if(e.message.includes("non-structured-clonable"))return!0;throw e})).catch(console.error)))return alert("An error was encountered whilst attempting to parse assignments.");let r=void 0;for(;void 0===r;)({savedCourse:r}=yield ne.default.storage.local.get("savedCourse"));ue(),r&&(le.parse.innerHTML=`Saved ${r}!`,e.reset(le.parse,1325))}))),le.export.addEventListener("click",()=>se(void 0,void 0,void 0,(function*(){le.export.innerHTML="Exporting to Notion...";const t=yield(0,X.exportToNotion)();if(t){const r=t.length?t.reduce((e,{course:t,name:r},a)=>e+`${a+1}. ${t} ${r}\n`,"\n\n"):"";le.export.innerHTML=`Imported ${t.length} assignments!`,e.reset(le.export,3500),alert(`Created ${t.length} new assignments.${r}`)}}))),le.viewJSON.addEventListener("click",()=>se(void 0,void 0,void 0,(function*(){const e=oe("saved-courses-list");if(e){const{savedAssignments:t}=yield ne.default.storage.local.get({savedAssignments:{}});de(le.viewJSON,"none"),de(le.listCourses,"inline-block"),e.innerHTML=`<p><code>${JSON.stringify(t).replace(/,/g,",<wbr>")}</code></p>`}}))),le.listCourses.addEventListener("click",()=>ue()),le.copyJSON.addEventListener("click",()=>se(void 0,void 0,void 0,(function*(){const{savedAssignments:t}=yield ne.default.storage.local.get({savedAssignments:{}});yield navigator.clipboard.writeText(JSON.stringify(t)),le.copyJSON.innerHTML="Copied to clipboard!",e.reset(le.copyJSON,1325)}))),le.clearStorage.addEventListener("click",()=>{if("I'm sure!"!==le.clearStorage.innerHTML)return le.clearStorage.innerHTML="I'm sure!",e.reset(le.clearStorage,1325);ne.default.storage.local.remove("savedAssignments"),ue(),le.clearStorage.innerHTML="Cleared saved assignments!",e.reset(le.clearStorage,3500)})}function ue(){return se(this,void 0,void 0,(function*(){const e=oe("saved-courses-list");if(e){const{savedAssignments:t}=yield ne.default.storage.local.get({savedAssignments:{}}),r=Object.entries(t).reduce((e,[t,r])=>e+`<li>${t} (<code>${r.length}</code> assignments)</li>\n`,"");de(le.listCourses,"none"),de(le.viewJSON,"inline-block"),e.innerHTML=r?`<ol>${r}</ol>`:"<p>No saved courses.</p>"}}))}ue()}();